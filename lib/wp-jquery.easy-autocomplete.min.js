var EasyAutocomplete=function(e){return e.main=function(t,n){var i,a=new e.Constans,o=new e.Configuration(n),r=new e.Logger,s=new e.Template(n.template),u=new e.ListBuilderService(o,e.proccess),c=o.equals,l=t,f="",d=[],g=-1;function m(){var e;function t(e,t){return o.get("highlightPhrase")&&""!==t?function(e,t){var n=(i=t,i.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"));var i;return(e+"").replace(new RegExp("("+n+")","gi"),"<b>$1</b>")}(e,t):e}l.parent().hasClass(a.getValue("WRAPPER_CSS_CLASS"))&&(l.next("."+a.getValue("CONTAINER_CLASS")).remove(),l.unwrap()),function(){var e=jQuery("<div>"),t=a.getValue("WRAPPER_CSS_CLASS");o.get("theme")&&""!==o.get("theme")&&(t+=" eac-"+o.get("theme"));o.get("cssClasses")&&""!==o.get("cssClasses")&&(t+=" "+o.get("cssClasses"));""!==s.getTemplateClass()&&(t+=" "+s.getTemplateClass());e.addClass(t),l.wrap(e),!0===o.get("adjustWidth")&&(n=l.outerWidth(),l.parent().css("width",n));var n}(),(e=jQuery("<div>").addClass(a.getValue("CONTAINER_CLASS"))).attr("id",p()).prepend(jQuery("<ul>")),e.on("show.eac",function(){switch(o.get("list").showAnimation.type){case"slide":var t=o.get("list").showAnimation.time,n=o.get("list").showAnimation.callback;e.find("ul").slideDown(t,n);break;case"fade":var t=o.get("list").showAnimation.time,n=o.get("list").showAnimation.callback;e.find("ul").fadeIn(t);break;default:e.find("ul").show()}o.get("list").onShowListEvent()}).on("hide.eac",function(){switch(o.get("list").hideAnimation.type){case"slide":var t=o.get("list").hideAnimation.time,n=o.get("list").hideAnimation.callback;e.find("ul").slideUp(t,n);break;case"fade":var t=o.get("list").hideAnimation.time,n=o.get("list").hideAnimation.callback;e.find("ul").fadeOut(t,n);break;default:e.find("ul").hide()}o.get("list").onHideListEvent()}).on("selectElement.eac",function(){e.find("ul li").removeClass("selected"),e.find("ul li").eq(g).addClass("selected"),o.get("list").onSelectItemEvent()}).on("loadElements.eac",function(n,i,a){var r="",u=e.find("ul");u.empty().detach(),d=[];for(var c=0,f=0,m=i.length;f<m;f+=1){var p=i[f].data;if(0!==p.length){void 0!==i[f].header&&i[f].header.length>0&&u.append("<div class='eac-category' >"+i[f].header+"</div>");for(var h=0,v=p.length;h<v&&c<i[f].maxListSize;h+=1)r=jQuery("<li><div class='eac-item'></div></li>"),function(){var e=h,n=c,u=i[f].getValue(p[e]);r.find(" > div").on("click",function(){l.val(u).trigger("change"),g=n,y(n),o.get("list").onClickEvent(),o.get("list").onChooseEvent()}).mouseover(function(){g=n,y(n),o.get("list").onMouseOverEvent()}).mouseout(function(){o.get("list").onMouseOutEvent()}).html(s.build(t(u,a),p[e]))}(),u.append(r),d.push(p[h]),c+=1}}e.append(u),o.get("list").onLoadEvent()}),l.after(e),f=jQuery("#"+p()),o.get("placeholder")&&l.attr("placeholder",o.get("placeholder"))}function p(){var e=l.attr("id");return e=a.getValue("CONTAINER_ID")+e}function h(){f.trigger("show.eac")}function v(){f.trigger("hide.eac")}function y(e){f.trigger("selectElement.eac",e)}function E(e,t){f.trigger("loadElements.eac",[e,t])}e.consts=a,this.getConstants=function(){return a},this.getConfiguration=function(){return o},this.getContainer=function(){return f},this.getSelectedItemIndex=function(){return g},this.getItems=function(){return d},this.getItemData=function(e){return d.length<e||void 0===d[e]?-1:d[e]},this.getSelectedItemData=function(){return this.getItemData(g)},this.build=function(){m()},this.init=function(){!function(){if(0===l.length)return void r.error("Input field doesn't exist.");if(!o.checkDataUrlProperties())return void r.error("One of options variables 'data' or 'url' must be defined.");if(!o.checkRequiredProperties())return void r.error("Will not work without mentioned properties.");m(),function(){function e(){l.off("keyup").keyup(function(e){switch(e.keyCode){case 27:v(),l.trigger("blur");break;case 38:e.preventDefault(),d.length>0&&g>0&&(g-=1,l.val(o.get("getValue")(d[g])),y(g));break;case 40:e.preventDefault(),d.length>0&&g<d.length-1&&(g+=1,l.val(o.get("getValue")(d[g])),y(g));break;default:if(e.keyCode>40||8===e.keyCode){var t=l.val();!0!==o.get("list").hideOnEmptyPhrase||8!==e.keyCode||""!==t?o.get("requestDelay")>0?(void 0!==i&&clearTimeout(i),i=setTimeout(function(){n(t)},o.get("requestDelay"))):n(t):v()}}function n(e){if(!(e.length<o.get("minCharNumber"))){if("list-required"!==o.get("data")){var t=o.get("data"),n=u.init(t);n=u.updateCategories(n,t),E(n=u.processData(n,e),e),l.parent().find("li").length>0?h():v()}var i=function(){var e={},t=o.get("ajaxSettings")||{};for(var n in t)e[n]=t[n];return e}();void 0!==i.url&&""!==i.url||(i.url=o.get("url")),void 0!==i.dataType&&""!==i.dataType||(i.dataType=o.get("dataType")),void 0!==i.url&&"list-required"!==i.url&&(i.url=i.url(e),i.data=o.get("preparePostData")(i.data,e),jQuery.ajax(i).done(function(t){var n=u.init(t);n=u.updateCategories(n,t),n=u.convertXml(n),function(e,t){return!1===o.get("matchResponseProperty")||("string"==typeof o.get("matchResponseProperty")?t[o.get("matchResponseProperty")]===e:"function"!=typeof o.get("matchResponseProperty")||o.get("matchResponseProperty")(t)===e)}(e,t)&&E(n=u.processData(n,e),e),u.checkIfDataExists(n)&&l.parent().find("li").length>0?h():v(),o.get("ajaxCallback")()}).fail(function(){r.warning("Fail to load response data")}).always(function(){}))}}})}!function(){c("autocompleteOff",!0)&&l.attr("autocomplete","off");l.focusout(function(){var e,t=l.val();o.get("list").match.caseSensitive||(t=t.toLowerCase());for(var n=0,i=d.length;n<i;n+=1)if(e=o.get("getValue")(d[n]),o.get("list").match.caseSensitive||(e=e.toLowerCase()),e===t)return void y(g=n)}),e(),l.on("keydown",function(e){var t=(e=e||window.event).keyCode;if(38===t)return suppressKeypress=!0,!1}).keydown(function(e){13===e.keyCode&&g>-1&&(l.val(o.get("getValue")(d[g])),o.get("list").onKeyEnterEvent(),o.get("list").onChooseEvent(),g=-1,v(),e.preventDefault())}),l.off("keypress"),l.focus(function(){""!==l.val()&&d.length>0&&(g=-1,h())}),l.blur(function(){setTimeout(function(){g=-1,v()},250)})}()}()}()}},e.eacHandles=[],e.getHandle=function(t){return e.eacHandles[t]},e.inputHasId=function(e){return void 0!==jQuery(e).attr("id")&&jQuery(e).attr("id").length>0},e.assignRandomId=function(t){var n="";do{n="eac-"+Math.floor(1e4*Math.random())}while(0!==jQuery("#"+n).length);elementId=e.consts.getValue("CONTAINER_ID")+n,jQuery(t).attr("id",n)},e.setHandle=function(t,n){e.eacHandles[n]=t},e}((EasyAutocomplete=function(e){return e.Template=function(e){var t={basic:{type:"basic",method:function(e){return e},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(e){return e+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(e){return e},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(e){return e},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(e){return e},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}};this.getTemplateClass=function(e){var n,i=function(){return""};return e&&e.type&&e.type&&t[e.type]?(n=t[e.type].cssClass,function(){return n}):i}(e),this.build=function(e){return e&&e.type&&e.type&&t[e.type]?(a=(n=e).fields,"description"===n.type?(i=t.description.method,"string"==typeof a.description?i=function(e,t){return e+" - <span>"+t[a.description]+"</span>"}:"function"==typeof a.description&&(i=function(e,t){return e+" - <span>"+a.description(t)+"</span>"}),i):"iconRight"===n.type?("string"==typeof a.iconSrc?i=function(e,t){return e+"<img class='eac-icon' src='"+t[a.iconSrc]+"' />"}:"function"==typeof a.iconSrc&&(i=function(e,t){return e+"<img class='eac-icon' src='"+a.iconSrc(t)+"' />"}),i):"iconLeft"===n.type?("string"==typeof a.iconSrc?i=function(e,t){return"<img class='eac-icon' src='"+t[a.iconSrc]+"' />"+e}:"function"==typeof a.iconSrc&&(i=function(e,t){return"<img class='eac-icon' src='"+a.iconSrc(t)+"' />"+e}),i):"links"===n.type?("string"==typeof a.link?i=function(e,t){return"<a href='"+t[a.link]+"' >"+e+"</a>"}:"function"==typeof a.link&&(i=function(e,t){return"<a href='"+a.link(t)+"' >"+e+"</a>"}),i):"custom"===n.type?n.method:t.basic.method):t.basic.method;var n,i,a}(e)},e}((EasyAutocomplete=function(e){return e.proccess=function(t,n,i){e.proccess.match=o;var a=n.data;return a=function(e){t.get("list").sort.enabled&&e.sort(t.get("list").sort.method);return e}(a=function(e){void 0!==n.maxNumberOfElements&&e.length>n.maxNumberOfElements&&(e=e.slice(0,n.maxNumberOfElements));return e}(a=function(e,n){var i=[];if(t.get("list").match.enabled)for(var a=0,r=e.length;a<r;a+=1)o(t.get("getValue")(e[a]),n)&&i.push(e[a]);else i=e;return i}(a,i)));function o(e,n){return t.get("list").match.caseSensitive||("string"==typeof e&&(e=e.toLowerCase()),n=n.toLowerCase()),!!t.get("list").match.method(e,n)}},e}((EasyAutocomplete=function(e){return e.ListBuilderService=function(e,t){function n(t,n){var i={};if(i="XML"===e.get("dataType").toUpperCase()?function(){var i,a={};void 0!==t.xmlElementName&&(a.xmlElementName=t.xmlElementName);void 0!==t.listLocation?i=t.listLocation:void 0!==e.get("listLocation")&&(i=e.get("listLocation"));void 0!==i?"string"==typeof i?a.data=jQuery(n).find(i):"function"==typeof i&&(a.data=i(n)):a.data=n;return a}():function(){var e={};void 0!==t.listLocation?"string"==typeof t.listLocation?e.data=n[t.listLocation]:"function"==typeof t.listLocation&&(e.data=t.listLocation(n)):e.data=n;return e}(),void 0!==t.header&&(i.header=t.header),void 0!==t.maxNumberOfElements&&(i.maxNumberOfElements=t.maxNumberOfElements),void 0!==e.get("list").maxNumberOfElements&&(i.maxListSize=e.get("list").maxNumberOfElements),void 0!==t.getValue)if("string"==typeof t.getValue){var a=t.getValue;i.getValue=function(e){return e[a]}}else"function"==typeof t.getValue&&(i.getValue=t.getValue);else i.getValue=e.get("getValue");return i}function i(t){var n=[];return void 0===t.xmlElementName&&(t.xmlElementName=e.get("xmlElementName")),jQuery(t.data).find(t.xmlElementName).each(function(){n.push(this)}),n}this.init=function(t){var n=[],i={};return i.data=e.get("listLocation")(t),i.getValue=e.get("getValue"),i.maxListSize=e.get("list").maxNumberOfElements,n.push(i),n},this.updateCategories=function(t,i){if(e.get("categoriesAssigned")){t=[];for(var a=0;a<e.get("categories").length;a+=1){var o=n(e.get("categories")[a],i);t.push(o)}}return t},this.convertXml=function(t){if("XML"===e.get("dataType").toUpperCase())for(var n=0;n<t.length;n+=1)t[n].data=i(t[n]);return t},this.processData=function(n,i){for(var a=0,o=n.length;a<o;a+=1)n[a].data=t(e,n[a],i);return n},this.checkIfDataExists=function(e){for(var t=0,n=e.length;t<n;t+=1)if(void 0!==e[t].data&&e[t].data instanceof Array&&e[t].data.length>0)return!0;return!1}},e}((EasyAutocomplete=function(e){return e.Constans=function(){var e={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(t){return e[t]}},e}((EasyAutocomplete=function(e){return e.Logger=function(){this.error=function(e){console.log("ERROR: "+e)},this.warning=function(e){console.log("WARNING: "+e)}},e}((EasyAutocomplete=function(e){return e.Configuration=function(e){var t={data:"list-required",url:"list-required",dataType:"json",listLocation:function(e){return e},xmlElementName:"",getValue:function(e){return e},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},matchResponseProperty:!1,list:{sort:{enabled:!1,method:function(e,n){return(e=t.getValue(e))<(n=t.getValue(n))?-1:e>n?1:0}},maxNumberOfElements:6,hideOnEmptyPhrase:!0,match:{enabled:!1,caseSensitive:!1,method:function(e,t){return e.search(t)>-1}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:!0,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:!0,ajaxSettings:{type:"POST"},preparePostData:function(e,t){return e},loggerEnabled:!0,template:"",categoriesAssigned:!1,categories:[{maxNumberOfElements:4}]},n=["ajaxSettings","template"];function i(e,i){!function e(t,i){for(var a in i)void 0===t[a]&&console.log("Property '"+a+"' does not exist in EasyAutocomplete options API."),"object"==typeof t[a]&&-1===jQuery.inArray(a,n)&&e(t[a],i[a])}(t,i)}this.get=function(e){return t[e]},this.equals=function(e,n){return!(!function(e){return void 0!==t[e]&&null!==t[e]}(e)||t[e]!==n)},this.checkDataUrlProperties=function(){return"list-required"!==t.url||"list-required"!==t.data},this.checkRequiredProperties=function(){for(var e in t)if("required"===t[e])return logger.error("Option "+e+" must be defined"),!1;return!0},this.printPropertiesThatDoesntExist=function(e,t){i(e,t)},function(){"xml"===e.dataType&&(e.getValue||(e.getValue=function(e){return jQuery(e).text()}),e.list||(e.list={}),e.list.sort||(e.list.sort={}),e.list.sort.method=function(t,n){return t=e.getValue(t),n=e.getValue(n),t<n?-1:t>n?1:0},e.list.match||(e.list.match={}),e.list.match.method=function(e,t){return e.search(t)>-1});if(void 0!==e.categories&&e.categories instanceof Array){for(var n=[],i=0,a=e.categories.length;i<a;i+=1){var o=e.categories[i];for(var r in t.categories[0])void 0===o[r]&&(o[r]=t.categories[0][r]);n.push(o)}e.categories=n}}(),function(){t=function e(t,n){var i=t||{};for(var a in t)void 0!==n[a]&&null!==n[a]&&("object"!=typeof n[a]||n[a]instanceof Array?i[a]=n[a]:e(t[a],n[a]));void 0!==n.data&&null!==n.data&&"object"==typeof n.data&&(i.data=n.data);return i}(t,e)}(),!0===t.loggerEnabled&&i(console,e),void 0!==e.ajaxSettings&&"object"==typeof e.ajaxSettings?t.ajaxSettings=e.ajaxSettings:t.ajaxSettings={},function(){if("list-required"!==t.url&&"function"!=typeof t.url){var n=t.url;t.url=function(){return n}}if(void 0!==t.ajaxSettings.url&&"function"!=typeof t.ajaxSettings.url){var n=t.ajaxSettings.url;t.ajaxSettings.url=function(){return n}}if("string"==typeof t.listLocation){var i=t.listLocation;"XML"===t.dataType.toUpperCase()?t.listLocation=function(e){return jQuery(e).find(i)}:t.listLocation=function(e){return e[i]}}if("string"==typeof t.getValue){var a=t.getValue;t.getValue=function(e){return e[a]}}void 0!==e.categories&&(t.categoriesAssigned=!0)}()},e}(EasyAutocomplete||{}))||{}))||{}))||{}))||{}))||{}))||{});!function(e){e.fn.easyAutocomplete=function(e){return this.each(function(){var t=jQuery(this),n=new EasyAutocomplete.main(t,e);EasyAutocomplete.inputHasId(t)||EasyAutocomplete.assignRandomId(t),n.init(),EasyAutocomplete.setHandle(n,t.attr("id"))})},e.fn.getSelectedItemIndex=function(){var e=jQuery(this).attr("id");return void 0!==e?EasyAutocomplete.getHandle(e).getSelectedItemIndex():-1},e.fn.getItems=function(){var e=jQuery(this).attr("id");return void 0!==e?EasyAutocomplete.getHandle(e).getItems():-1},e.fn.getItemData=function(e){var t=jQuery(this).attr("id");return void 0!==t&&e>-1?EasyAutocomplete.getHandle(t).getItemData(e):-1},e.fn.getSelectedItemData=function(){var e=jQuery(this).attr("id");return void 0!==e?EasyAutocomplete.getHandle(e).getSelectedItemData():-1}}(jQuery);